{"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"modules":[{"name":"Lockman"}],"role":"article","roleHeading":"Article","title":"SingleExecutionStrategy"},"seeAlsoSections":[{"identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy"],"anchor":"Strategies","title":"Strategies","generated":true}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/lockman\/singleexecutionstrategy"]}],"primaryContentSections":[{"content":[{"anchor":"Overview","text":"Overview","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"SingleExecutionStrategy is a strategy for preventing duplicate execution. It prevents the same processing from being executed redundantly, maintaining data consistency and application stability."}]},{"type":"paragraph","inlineContent":[{"text":"This is the most frequently used basic strategy for preventing continuous user operations and duplicate execution of automatic processing.","type":"text"}]},{"anchor":"Execution-Modes","text":"Execution Modes","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"text":"SingleExecutionStrategy supports three execution modes:","type":"text"}]},{"anchor":"none-No-Control","text":"none - No Control","type":"heading","level":3},{"syntax":"swift","code":["LockmanSingleExecutionInfo(","    actionId: \"save\",","    mode: .none",")"],"type":"codeListing"},{"items":[{"content":[{"inlineContent":[{"text":"Executes all processing without exclusive control","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Used when temporarily disabling lock functionality"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Applied for behavior verification during debugging or testing","type":"text"}]}]}],"type":"unorderedList"},{"anchor":"boundary-Boundary-level-Exclusive-Control","text":"boundary - Boundary-level Exclusive Control","type":"heading","level":3},{"syntax":"swift","code":["LockmanSingleExecutionInfo(","    actionId: \"save\", ","    mode: .boundary",")"],"type":"codeListing"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Only one process can execute within the same boundary"}]}]},{"content":[{"inlineContent":[{"text":"Exclusive control at screen or component level","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Applied when wanting to control entire UI operations","type":"text"}]}]}],"type":"unorderedList"},{"anchor":"action-Action-level-Exclusive-Control","text":"action - Action-level Exclusive Control","type":"heading","level":3},{"syntax":"swift","code":["LockmanSingleExecutionInfo(","    actionId: \"save\",","    mode: .action  ",")"],"type":"codeListing"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Prevents only duplicate execution of the same action"}]}]},{"content":[{"inlineContent":[{"text":"Different actions can execute concurrently","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Applied when wanting to control only specific processing","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Usage","text":"Usage","type":"heading","level":2},{"anchor":"Basic-Usage-Example","text":"Basic Usage Example","type":"heading","level":3},{"syntax":"swift","code":["@LockmanSingleExecution","enum ViewAction {","    case save","    case load","    ","    var lockmanInfo: LockmanSingleExecutionInfo {","        switch self {","        case .save:","            return LockmanSingleExecutionInfo(","                actionId: actionName,","                mode: .action","            )","        case .load:","            return LockmanSingleExecutionInfo(","                actionId: actionName,","                mode: .action","            )","        }","    }","}"],"type":"codeListing"},{"anchor":"Usage-with-Reducerlock","text":"Usage with Reducer.lock()","type":"heading","level":3},{"syntax":"swift","code":["var body: some ReducerOf<Self> {","    Reduce { state, action in","        switch action {","        case .saveButtonTapped:","            return .run { send in","                try await saveUserData()","                await send(.saveCompleted)","            }","            .catch { error, send in","                await send(.saveError(error.localizedDescription))","            }","            ","        case .loadButtonTapped:","            return .run { send in","                let data = try await loadUserData()","                await send(.loadCompleted(data))","            }","            \/\/ Other cases...","        }","    }","    .lock(","        boundaryId: CancelID.userAction,","        lockFailure: { error, send in","            if let singleError = error as? LockmanSingleExecutionCancellationError,","               case .actionAlreadyRunning(let info) = singleError.reason {","                await send(.showBusyMessage(\"\\(info.actionId) is currently running\"))","            }","        }","    )","}"],"type":"codeListing"},{"anchor":"Advanced-Usage-with-withLock","text":"Advanced Usage with withLock","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"For cases requiring fine-grained control:"}]},{"syntax":"swift","code":["case .saveButtonTapped:","    return .withLock(","        operation: { send in","            try await saveUserData()","            await send(.saveCompleted)","        },","        catch handler: { error, send in","            await send(.saveError(error.localizedDescription))","        },","        lockFailure: { error, send in","            await send(.saveBusy(\"Save process is currently running\"))","        },","        action: action,","        boundaryId: CancelID.userAction","    )"],"type":"codeListing"},{"anchor":"Operation-Examples","text":"Operation Examples","type":"heading","level":2},{"anchor":"action-mode","text":"action mode","type":"heading","level":3},{"syntax":null,"code":["Time: 0s  - save action starts ‚Üí ‚úÖ Execute","Time: 1s  - save action request ‚Üí ‚ùå Reject (same action running)","Time: 1s  - load action request ‚Üí ‚úÖ Execute (different action)","Time: 3s  - save action complete ‚Üí üîì Unlock","Time: 4s  - save action request ‚Üí ‚úÖ Execute (previous process completed)"],"type":"codeListing"},{"anchor":"boundary-mode","text":"boundary mode","type":"heading","level":3},{"syntax":null,"code":["Time: 0s  - save action starts ‚Üí ‚úÖ Execute","Time: 1s  - save action request ‚Üí ‚ùå Reject (running within boundary)","Time: 1s  - load action request ‚Üí ‚ùå Reject (running within boundary)","Time: 3s  - save action complete ‚Üí üîì Unlock","Time: 4s  - load action request ‚Üí ‚úÖ Execute (boundary process completed)"],"type":"codeListing"},{"anchor":"Error-Handling","text":"Error Handling","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"For errors that may occur with SingleExecutionStrategy and their solutions, please also refer to the common patterns on the "},{"isActive":true,"overridingTitle":"Error Handling","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","type":"reference","overridingTitleInlineContent":[{"type":"text","text":"Error Handling"}]},{"type":"text","text":" page."}]},{"anchor":"LockmanSingleExecutionCancellationError","text":"LockmanSingleExecutionCancellationError","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"This error conforms to "},{"type":"codeVoice","code":"LockmanCancellationError"},{"type":"text","text":" protocol and provides:"}]},{"items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"cancelledInfo"},{"type":"text","text":": Information about the cancelled action"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"boundaryId"},{"type":"text","text":": Where the cancellation occurred"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"reason","type":"codeVoice"},{"text":": Specific reason for cancellation","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"CancellationReason cases:","type":"text"}]}]},{"items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"boundaryAlreadyLocked","type":"text"}]},{"type":"text","text":" - Boundary is already locked"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"existingInfo"},{"type":"text","text":": Existing lock information"}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"actionAlreadyRunning"}]},{"type":"text","text":" - Same action is already running"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"code":"existingInfo","type":"codeVoice"},{"type":"text","text":": Running action information"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"syntax":"swift","code":["lockFailure: { error, send in","    if let singleError = error as? LockmanSingleExecutionCancellationError {","        switch singleError.reason {","        case .boundaryAlreadyLocked(let existingInfo):","            send(.showBusyMessage(\"Another process is running: \\(existingInfo.actionId)\"))","        case .actionAlreadyRunning(let existingInfo):","            send(.showBusyMessage(\"\\(existingInfo.actionId) is running\"))","        }","    } else {","        send(.showBusyMessage(\"Cannot start processing\"))","    }","}"],"type":"codeListing"}],"kind":"content"}],"identifier":{"url":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"abstract":[{"type":"text","text":"Prevent duplicate execution of the same action."}],"kind":"article","sections":[],"references":{"doc://Lockman/documentation/Lockman/DynamicConditionStrategy":{"abstract":[{"text":"Control actions based on runtime conditions.","type":"text"}],"role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","title":"DynamicConditionStrategy","kind":"article","url":"\/documentation\/lockman\/dynamicconditionstrategy","type":"topic"},"doc://Lockman/documentation/Lockman/ErrorHandling":{"type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","url":"\/documentation\/lockman\/errorhandling","title":"Error Handling","kind":"article","abstract":[{"text":"Learn about common error handling patterns in Lockman.","type":"text"}],"role":"article"},"doc://Lockman/documentation/Lockman/PriorityBasedStrategy":{"abstract":[{"text":"Control action execution based on priority levels.","type":"text"}],"title":"PriorityBasedStrategy","kind":"article","url":"\/documentation\/lockman\/prioritybasedstrategy","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","type":"topic"},"doc://Lockman/documentation/Lockman/CompositeStrategy":{"abstract":[{"type":"text","text":"Combine multiple strategies for complex control scenarios."}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy","kind":"article","role":"article","url":"\/documentation\/lockman\/compositestrategy","title":"CompositeStrategy","type":"topic"},"doc://Lockman/documentation/Lockman":{"role":"collection","abstract":[{"type":"text","text":"A library to implement exclusive control of user actions in application development using TCA."}],"url":"\/documentation\/lockman","type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman","title":"Lockman","kind":"symbol"},"doc://Lockman/documentation/Lockman/ConcurrencyLimitedStrategy":{"type":"topic","url":"\/documentation\/lockman\/concurrencylimitedstrategy","title":"ConcurrencyLimitedStrategy","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","abstract":[{"type":"text","text":"Limit the number of concurrent executions."}],"kind":"article"},"doc://Lockman/documentation/Lockman/GroupCoordinationStrategy":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","title":"GroupCoordinationStrategy","role":"article","url":"\/documentation\/lockman\/groupcoordinationstrategy","abstract":[{"text":"Coordinate actions through leader\/member group roles.","type":"text"}],"type":"topic"}}}