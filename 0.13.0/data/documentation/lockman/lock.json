{"sections":[],"primaryContentSections":[{"content":[{"text":"Overview","level":2,"anchor":"Overview","type":"heading"},{"inlineContent":[{"type":"text","text":"Locking in Lockman is a strategy-based exclusive control system. Unlike traditional simple ON\/OFF control, the selected strategy enables various types of control:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Execution Prevention","type":"text"}]},{"type":"text","text":": Blocking duplicate execution ("},{"type":"reference","overridingTitleInlineContent":[{"type":"text","text":"SingleExecutionStrategy"}],"isActive":true,"overridingTitle":"SingleExecutionStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy"},{"type":"text","text":")"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Execution Priority","type":"text"}],"type":"strong"},{"text":": Prioritizing new processing by interrupting existing processing (","type":"text"},{"isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"PriorityBasedStrategy"}],"type":"reference","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","overridingTitle":"PriorityBasedStrategy"},{"text":")","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Execution Coordination"}]},{"type":"text","text":": Coordinating related processing groups ("},{"type":"reference","isActive":true,"overridingTitleInlineContent":[{"text":"GroupCoordinationStrategy","type":"text"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","overridingTitle":"GroupCoordinationStrategy"},{"type":"text","text":")"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Execution Limitation","type":"text"}]},{"text":": Limiting concurrent execution count (","type":"text"},{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","overridingTitle":"ConcurrencyLimitedStrategy","overridingTitleInlineContent":[{"type":"text","text":"ConcurrencyLimitedStrategy"}],"isActive":true,"type":"reference"},{"text":")","type":"text"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Conditional Execution Control"}],"type":"strong"},{"text":": Dynamic conditional control through custom logic (","type":"text"},{"isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"DynamicConditionStrategy"}],"overridingTitle":"DynamicConditionStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","type":"reference"},{"text":")","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"text":"Specifications","level":2,"anchor":"Specifications","type":"heading"},{"inlineContent":[{"text":"Lockman determines the success or failure of lock acquisition based on the strategy and executes processing according to the result. The lock acquisition judgment process follows the rules of the specified strategy, and when multiple strategies are specified with ","type":"text"},{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy","type":"reference","isActive":true,"overridingTitle":"CompositeStrategy","overridingTitleInlineContent":[{"text":"CompositeStrategy","type":"text"}]},{"text":", lock acquisition succeeds only when all strategies allow it.","type":"text"}],"type":"paragraph"},{"text":"Methods","level":2,"anchor":"Methods","type":"heading"},{"inlineContent":[{"type":"text","text":"Lockman provides three main methods that can be used according to different purposes."}],"type":"paragraph"},{"text":"withLock (Auto-release Version)","level":3,"anchor":"withLock-Auto-release-Version","type":"heading"},{"inlineContent":[{"type":"text","text":"The most basic and recommended usage. Automatically manages lock acquisition and release."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":[".withLock(","  priority: .userInitiated, \/\/ Optional: Task priority","  unlockOption: .immediate, \/\/ Optional: Lock release timing","  operation: { send in \/* Processing *\/ },","  catch handler: { error, send in \/* Error handling *\/ }, \/\/ Optional","  lockFailure: { error, send in \/* Lock acquisition failure handling *\/ }, \/\/ Optional","  action: action,","  cancelID: cancelID",")"]},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Parameters:","type":"text"}]}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"priority"},{"text":": Task priority (optional)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"unlockOption"},{"type":"text","text":": Lock release timing (optional, default is configured value)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"handleCancellationErrors"},{"text":": Handling of cancellation errors (optional, default is configured value)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"operation","type":"codeVoice"},{"text":": Processing to execute under exclusive control","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"catch handler"},{"type":"text","text":": Error handler (optional)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"lockFailure","type":"codeVoice"},{"text":": Handler for lock acquisition failure (optional)","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"action"},{"text":": Current action","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"cancelID","type":"codeVoice"},{"text":": Effect cancellation identifier","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Features:"}]}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Automatic lock management","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Reliable lock release on normal completion, exception, or cancellation","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Error handling capability","type":"text"}]}]}],"type":"unorderedList"},{"text":"withLock (Manual Release Version)","level":3,"anchor":"withLock-Manual-Release-Version","type":"heading"},{"inlineContent":[{"text":"Used when you want to manually control the lock release timing. Parameters are the same as the auto-release version, but an unlock parameter is added to ","type":"text"},{"code":"operation","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"catch handler","type":"codeVoice"},{"text":".","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":[".withLock(","  operation: { send, unlock in ","    \/* Processing *\/","    unlock() \/\/ Manual release","  },","  catch handler: { error, send, unlock in ","    unlock() \/\/ Release on error too","  },","  action: action,","  cancelID: cancelID",")"]},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Features:"}],"type":"strong"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Explicit lock release control","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Finer control possible"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Important","type":"text"}],"type":"strong"},{"type":"text","text":": You must call unlock() in all code paths (see "},{"overridingTitleInlineContent":[{"type":"text","text":"Unlock"}],"isActive":true,"type":"reference","overridingTitle":"Unlock","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Unlock"},{"type":"text","text":" page for details)"}]}]}],"type":"unorderedList"},{"text":"concatenateWithLock","level":3,"anchor":"concatenateWithLock","type":"heading"},{"inlineContent":[{"text":"Maintains the same lock while executing multiple Effects sequentially.","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":[".concatenateWithLock(","  unlockOption: .immediate, \/\/ Optional: Lock release timing","  operations: [","    .run { send in \/* Processing 1 *\/ },","    .run { send in \/* Processing 2 *\/ },","    .run { send in \/* Processing 3 *\/ }","  ],","  lockFailure: { error, send in \/* Lock acquisition failure handling *\/ }, \/\/ Optional","  action: action,","  cancelID: cancelID",")"]},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Features:"}],"type":"strong"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Maintains the same lock across multiple Effects"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Suitable for transactional processing","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"If any one fails, the entire process is interrupted"}],"type":"paragraph"}]}],"type":"unorderedList"}],"kind":"content"}],"seeAlsoSections":[{"generated":true,"identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/GettingStarted","doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","doc:\/\/Lockman\/documentation\/Lockman\/Unlock","doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","doc:\/\/Lockman\/documentation\/Lockman\/Configuration","doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide"],"anchor":"Essentials","title":"Essentials"}],"abstract":[{"text":"Understanding the locking mechanism in Lockman.","type":"text"}],"variants":[{"paths":["\/documentation\/lockman\/lock"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Lockman\/documentation\/Lockman\/Lock","interfaceLanguage":"swift"},"schemaVersion":{"major":0,"minor":3,"patch":0},"kind":"article","metadata":{"title":"Lock","modules":[{"name":"Lockman"}],"role":"article","roleHeading":"Article"},"hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"references":{"doc://Lockman/documentation/Lockman/ErrorHandling":{"abstract":[{"text":"Learn about common error handling patterns in Lockman.","type":"text"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","title":"Error Handling","type":"topic","role":"article","kind":"article","url":"\/documentation\/lockman\/errorhandling"},"doc://Lockman/documentation/Lockman/ChoosingStrategy":{"title":"Choosing a Strategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","kind":"article","url":"\/documentation\/lockman\/choosingstrategy","role":"article","abstract":[{"text":"Learn how to select the right strategy for your use case.","type":"text"}],"type":"topic"},"doc://Lockman/documentation/Lockman/ConcurrencyLimitedStrategy":{"type":"topic","kind":"article","title":"ConcurrencyLimitedStrategy","role":"article","url":"\/documentation\/lockman\/concurrencylimitedstrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","abstract":[{"type":"text","text":"Limit the number of concurrent executions."}]},"doc://Lockman/documentation/Lockman/DynamicConditionStrategy":{"abstract":[{"type":"text","text":"Control actions based on runtime conditions."}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","role":"article","url":"\/documentation\/lockman\/dynamicconditionstrategy","type":"topic","kind":"article","title":"DynamicConditionStrategy"},"doc://Lockman/documentation/Lockman":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman","abstract":[{"text":"A library to implement exclusive control of user actions in application development using TCA.","type":"text"}],"url":"\/documentation\/lockman","kind":"symbol","title":"Lockman","role":"collection","type":"topic"},"doc://Lockman/documentation/Lockman/CompositeStrategy":{"abstract":[{"type":"text","text":"Combine multiple strategies for complex control scenarios."}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy","role":"article","url":"\/documentation\/lockman\/compositestrategy","type":"topic","kind":"article","title":"CompositeStrategy"},"doc://Lockman/documentation/Lockman/PriorityBasedStrategy":{"title":"PriorityBasedStrategy","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","type":"topic","url":"\/documentation\/lockman\/prioritybasedstrategy","kind":"article","abstract":[{"text":"Control action execution based on priority levels.","type":"text"}]},"doc://Lockman/documentation/Lockman/SingleExecutionStrategy":{"url":"\/documentation\/lockman\/singleexecutionstrategy","abstract":[{"type":"text","text":"Prevent duplicate execution of the same action."}],"title":"SingleExecutionStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","type":"topic","role":"article","kind":"article"},"doc://Lockman/documentation/Lockman/GettingStarted":{"role":"article","type":"topic","abstract":[{"type":"text","text":"Learn how to integrate Lockman into your TCA application."}],"url":"\/documentation\/lockman\/gettingstarted","title":"Getting Started","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GettingStarted","kind":"article"},"doc://Lockman/documentation/Lockman/Unlock":{"role":"article","url":"\/documentation\/lockman\/unlock","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Unlock","title":"Unlock","abstract":[{"text":"Understanding the unlocking mechanism in Lockman.","type":"text"}],"type":"topic","kind":"article"},"doc://Lockman/documentation/Lockman/DebuggingGuide":{"url":"\/documentation\/lockman\/debuggingguide","abstract":[{"type":"text","text":"Learn how to debug Lockman-related issues in your application."}],"kind":"article","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide","type":"topic","title":"Debugging Guide"},"doc://Lockman/documentation/Lockman/GroupCoordinationStrategy":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","role":"article","type":"topic","url":"\/documentation\/lockman\/groupcoordinationstrategy","abstract":[{"text":"Coordinate actions through leader\/member group roles.","type":"text"}],"title":"GroupCoordinationStrategy"},"doc://Lockman/documentation/Lockman/Configuration":{"type":"topic","title":"Configuration","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Configuration","url":"\/documentation\/lockman\/configuration","abstract":[{"text":"Configure Lockman for your applicationâ€™s needs.","type":"text"}],"role":"article","kind":"article"},"doc://Lockman/documentation/Lockman/BoundaryOverview":{"type":"topic","kind":"article","title":"Boundary","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","abstract":[{"text":"Understand the concept of boundaries in Lockman.","type":"text"}],"url":"\/documentation\/lockman\/boundaryoverview","role":"article"}}}