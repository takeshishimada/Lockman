{"metadata":{"modules":[{"name":"Lockman"}],"roleHeading":"Article","role":"article","title":"ConcurrencyLimitedStrategy"},"schemaVersion":{"patch":0,"major":0,"minor":3},"kind":"article","hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/lockman\/concurrencylimitedstrategy"]}],"abstract":[{"text":"Limit the number of concurrent executions.","type":"text"}],"seeAlsoSections":[{"title":"Strategies","generated":true,"anchor":"Strategies","identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy"]}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Overview","anchor":"Overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"ConcurrencyLimitedStrategy is a strategy that limits the number of concurrent executions. It allows concurrent execution up to a specified number and rejects execution when the limit is exceeded, enabling resource usage control and performance optimization."}]},{"type":"paragraph","inlineContent":[{"text":"This strategy is used for controlling the concurrency of resource-intensive operations such as network requests and file operations.","type":"text"}]},{"type":"heading","text":"Concurrency Limitation System","anchor":"Concurrency-Limitation-System","level":2},{"type":"heading","text":"Limit Types","anchor":"Limit-Types","level":3},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"unlimited","type":"text"}],"type":"strong"},{"type":"text","text":" - No limit"}]},{"syntax":"swift","code":["LockmanConcurrencyLimitedInfo(","    actionId: \"backgroundTask\",","    concurrencyId: \"background\",","    limit: .unlimited",")"],"type":"codeListing"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"No limit on the number of concurrent executions","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Used when you want to temporarily disable limits"}]}]},{"content":[{"inlineContent":[{"text":"Applied for behavior verification during debugging and testing","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"limited","type":"text"}]},{"type":"text","text":" - Numeric limit"}]},{"syntax":"swift","code":["LockmanConcurrencyLimitedInfo(","    actionId: \"download\",","    concurrencyId: \"downloads\", ","    limit: .limited(3)",")"],"type":"codeListing"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Allows concurrent execution up to the specified number"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Operations exceeding the limit are rejected","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Resource protection and performance optimization"}],"type":"paragraph"}]}]},{"type":"heading","text":"Concurrency Groups","anchor":"Concurrency-Groups","level":3},{"type":"paragraph","inlineContent":[{"text":"Operations with the same ","type":"text"},{"code":"concurrencyId","type":"codeVoice"},{"text":" are managed as a single group, and the number of concurrent executions is limited on a per-group basis.","type":"text"}]},{"syntax":"swift","code":["\/\/ Managed as the same group \"downloads\"","LockmanConcurrencyLimitedInfo(","    actionId: \"downloadImage\",","    concurrencyId: \"downloads\",","    limit: .limited(3)",")","","LockmanConcurrencyLimitedInfo(","    actionId: \"downloadVideo\", ","    concurrencyId: \"downloads\",","    limit: .limited(3)",")"],"type":"codeListing"},{"type":"heading","text":"Usage","anchor":"Usage","level":2},{"type":"heading","text":"Basic Usage Example","anchor":"Basic-Usage-Example","level":3},{"syntax":"swift","code":["@LockmanConcurrencyLimited","enum ViewAction {","    case downloadFile(URL)","    case uploadFile(URL)","    case processImage(UIImage)","    ","    var lockmanInfo: LockmanConcurrencyLimitedInfo {","        switch self {","        case .downloadFile:","            return LockmanConcurrencyLimitedInfo(","                actionId: actionName,","                concurrencyId: \"network\",","                limit: .limited(3)","            )","        case .uploadFile:","            return LockmanConcurrencyLimitedInfo(","                actionId: actionName,","                concurrencyId: \"network\", ","                limit: .limited(3)","            )","        case .processImage:","            return LockmanConcurrencyLimitedInfo(","                actionId: actionName,","                concurrencyId: \"imageProcessing\",","                limit: .limited(2)","            )","        }","    }","}"],"type":"codeListing"},{"type":"heading","text":"Group-specific Limit Configuration","anchor":"Group-specific-Limit-Configuration","level":3},{"syntax":"swift","code":["\/\/ Network-related: Maximum 3","LockmanConcurrencyLimitedInfo(","    actionId: \"apiCall\",","    concurrencyId: \"network\",","    limit: .limited(3)",")","","\/\/ Image operations: Maximum 2  ","LockmanConcurrencyLimitedInfo(","    actionId: \"imageResize\",","    concurrencyId: \"imageProcessing\", ","    limit: .limited(2)",")","","\/\/ Background tasks: No limit","LockmanConcurrencyLimitedInfo(","    actionId: \"logging\",","    concurrencyId: \"background\",","    limit: .unlimited",")"],"type":"codeListing"},{"type":"heading","text":"Behavior Examples","anchor":"Behavior-Examples","level":2},{"type":"heading","text":"Execution Control by Limits","anchor":"Execution-Control-by-Limits","level":3},{"syntax":null,"code":["Limit: 3","Concurrency Group: \"downloads\"","","Time: 0s  - download1 request → ✅ Execute (1\/3)","Time: 1s  - download2 request → ✅ Execute (2\/3)  ","Time: 2s  - download3 request → ✅ Execute (3\/3)","Time: 3s  - download4 request → ❌ Reject (limit reached)","Time: 4s  - download1 complete → ✅ Complete (2\/3)","Time: 5s  - download5 request → ✅ Execute (3\/3)"],"type":"codeListing"},{"type":"heading","text":"Independent Control in Different Groups","anchor":"Independent-Control-in-Different-Groups","level":3},{"syntax":null,"code":["Network Group (Limit: 3)","Time: 0s  - api1 execute, api2 execute, api3 execute → ✅ (3\/3)","Time: 1s  - api4 request → ❌ Reject","","Image Processing Group (Limit: 2)  ","Time: 0s  - resize1 execute, resize2 execute → ✅ (2\/2)","Time: 1s  - resize3 request → ❌ Reject","","※ Different groups are controlled independently"],"type":"codeListing"},{"type":"heading","text":"Error Handling","anchor":"Error-Handling","level":2},{"type":"paragraph","inlineContent":[{"text":"For errors that may occur in ConcurrencyLimitedStrategy and how to handle them, also refer to the common patterns on the ","type":"text"},{"isActive":true,"type":"reference","overridingTitle":"Error Handling","overridingTitleInlineContent":[{"text":"Error Handling","type":"text"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling"},{"text":" page.","type":"text"}]},{"type":"heading","text":"LockmanConcurrencyLimitedCancellationError","anchor":"LockmanConcurrencyLimitedCancellationError","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"This error conforms to "},{"type":"codeVoice","code":"LockmanCancellationError"},{"type":"text","text":" protocol and provides:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"cancelledInfo"},{"text":": Information about the cancelled action","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"boundaryId"},{"type":"text","text":": Where the cancellation occurred"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"existingInfos"},{"type":"text","text":": Array of currently active infos"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"currentCount"},{"type":"text","text":": Current number of active executions"}],"type":"paragraph"}]}]},{"syntax":"swift","code":["lockFailure: { error, send in","    if let concurrencyError = error as? LockmanConcurrencyLimitedCancellationError {","        let limit = concurrencyError.cancelledInfo.limit","        let current = concurrencyError.currentCount","        await send(.concurrencyLimitReached(","            \"Concurrency limit reached (\\(current)\/\\(limit))\"","        ))","    }","}"],"type":"codeListing"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy"},"sections":[],"references":{"doc://Lockman/documentation/Lockman/DynamicConditionStrategy":{"kind":"article","url":"\/documentation\/lockman\/dynamicconditionstrategy","type":"topic","role":"article","title":"Dynamic Condition Evaluation","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","abstract":[{"type":"text","text":"Control actions based on runtime conditions with unified condition evaluation."}]},"doc://Lockman/documentation/Lockman/PriorityBasedStrategy":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","role":"article","url":"\/documentation\/lockman\/prioritybasedstrategy","abstract":[{"text":"Control action execution based on priority levels.","type":"text"}],"title":"PriorityBasedStrategy","type":"topic"},"doc://Lockman/documentation/Lockman":{"url":"\/documentation\/lockman","kind":"symbol","identifier":"doc:\/\/Lockman\/documentation\/Lockman","abstract":[{"text":"Elegant exclusive control for user actions in The Composable Architecture applications.","type":"text"}],"role":"collection","title":"Lockman","type":"topic"},"doc://Lockman/documentation/Lockman/GroupCoordinationStrategy":{"kind":"article","abstract":[{"type":"text","text":"Coordinate actions through leader\/member group roles."}],"role":"article","url":"\/documentation\/lockman\/groupcoordinationstrategy","title":"GroupCoordinationStrategy","type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy"},"doc://Lockman/documentation/Lockman/SingleExecutionStrategy":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","type":"topic","abstract":[{"type":"text","text":"Prevent duplicate execution of the same action."}],"title":"SingleExecutionStrategy","url":"\/documentation\/lockman\/singleexecutionstrategy","role":"article","kind":"article"},"doc://Lockman/documentation/Lockman/CompositeStrategy":{"url":"\/documentation\/lockman\/compositestrategy","type":"topic","abstract":[{"type":"text","text":"Combine multiple strategies for complex control scenarios."}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy","title":"CompositeStrategy","kind":"article","role":"article"},"doc://Lockman/documentation/Lockman/ErrorHandling":{"kind":"article","url":"\/documentation\/lockman\/errorhandling","type":"topic","role":"article","title":"Error Handling","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","abstract":[{"text":"Learn about common error handling patterns in Lockman.","type":"text"}]}}}