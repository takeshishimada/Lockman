{"sections":[],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","anchor":"Prerequisites","text":"Prerequisites","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Before using Lockman, you should be familiar with:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"The Composable Architecture (TCA)","type":"text"}]},{"text":" fundamentals","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Basic Swift concurrency ("},{"type":"codeVoice","code":"async\/await"},{"type":"text","text":")"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"TCA’s Effect system","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"If you’re new to TCA, start with the ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/tutorials\/composablearchitecture\/"},{"text":" first.","type":"text"}]},{"type":"heading","anchor":"30-Second-Solution","text":"30-Second Solution","level":2},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Problem","type":"text"}]},{"type":"text","text":": Your save button can be tapped multiple times, causing duplicate network requests."}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Solution","type":"text"}]},{"type":"text","text":": Add one line to prevent duplicate executions:"}]},{"type":"codeListing","code":["@LockmanSingleExecution","enum ViewAction {","    case saveButtonTapped","    var lockmanInfo: LockmanSingleExecutionInfo { ","        .init(actionId: actionName, mode: .boundary) ","    }","}","","\/\/ Add this one line to your reducer:",".lock(boundaryId: CancelID.userAction, for: \\.view)"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Result","type":"text"}],"type":"strong"},{"type":"text","text":": The save button becomes “smart” - it won’t execute again until the current save completes."}]},{"type":"heading","anchor":"Overview","text":"Overview","level":2},{"type":"paragraph","inlineContent":[{"text":"This guide will teach you how to integrate Lockman into your The Composable Architecture (TCA) project step by step, starting with the simplest case and building up to more complex scenarios.","type":"text"}]},{"text":"Adding Lockman as a dependency","level":2,"anchor":"Adding-Lockman-as-a-dependency","type":"heading"},{"inlineContent":[{"type":"text","text":"To use Lockman in a Swift Package Manager project, add it to the dependencies in your "},{"type":"codeVoice","code":"Package.swift"},{"type":"text","text":" file:"}],"type":"paragraph"},{"code":["dependencies: [","  .package(url: \"https:\/\/github.com\/takeshishimada\/Lockman\", from: \"x.x.x\")","]"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"type":"text","text":"And add "},{"code":"Lockman","type":"codeVoice"},{"type":"text","text":" as a dependency of your package’s target:"}],"type":"paragraph"},{"code":[".target(","  name: \"YourTarget\",","  dependencies: [","    \"Lockman\",","    .product(name: \"ComposableArchitecture\", package: \"swift-composable-architecture\")","  ]",")"],"syntax":"swift","type":"codeListing"},{"text":"Step-by-Step Tutorial","level":2,"anchor":"Step-by-Step-Tutorial","type":"heading"},{"inlineContent":[{"text":"Let’s build a simple save feature that prevents duplicate executions. We’ll start minimal and add complexity gradually.","type":"text"}],"type":"paragraph"},{"text":"Step 1: Basic Setup","level":3,"anchor":"Step-1-Basic-Setup","type":"heading"},{"inlineContent":[{"text":"Create a minimal TCA feature with a save action:","type":"text"}],"type":"paragraph"},{"code":["import ComposableArchitecture","import Lockman","","@Reducer","struct SaveFeature {","    @ObservableState","    struct State: Equatable {","        var isSaving = false","        var message = \"\"","    }","    ","    enum Action {","        case saveButtonTapped","        case saveStarted","        case saveCompleted","    }","}"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"What we have"}],"type":"strong"},{"text":": A basic save feature with three simple actions.","type":"text"}],"type":"paragraph"},{"text":"Step 2: Add Basic Logic","type":"heading","anchor":"Step-2-Add-Basic-Logic","level":3},{"inlineContent":[{"type":"text","text":"Implement the basic save functionality:"}],"type":"paragraph"},{"code":["@Reducer","struct SaveFeature {","    \/\/ ... State from Step 1 ...","    ","    var body: some ReducerOf<Self> {","        Reduce { state, action in","            switch action {","            case .saveButtonTapped:","                state.isSaving = true","                state.message = \"Saving...\"","                return .run { send in","                    \/\/ Simulate save operation","                    try await Task.sleep(for: .seconds(2))","                    await send(.saveCompleted)","                }","                ","            case .saveStarted:","                state.isSaving = true","                state.message = \"Starting save...\"","                return .none","                ","            case .saveCompleted:","                state.isSaving = false","                state.message = \"Saved successfully!\"","                return .none","            }","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"inlineContent":[{"text":"Problem","type":"text"}],"type":"strong"},{"type":"text","text":": If users tap the save button multiple times, multiple save operations will run simultaneously."}],"type":"paragraph"},{"text":"Step 3: Add Lockman Protection","type":"heading","anchor":"Step-3-Add-Lockman-Protection","level":3},{"inlineContent":[{"type":"text","text":"Now let’s prevent duplicate saves by adding Lockman protection:"}],"type":"paragraph"},{"code":["@LockmanSingleExecution","enum Action {","    case saveButtonTapped","    case saveStarted  ","    case saveCompleted","    ","    var lockmanInfo: LockmanSingleExecutionInfo {","        switch self {","        case .saveButtonTapped:","            return .init(actionId: actionName, mode: .boundary)","        case .saveStarted, .saveCompleted:","            return .init(actionId: actionName, mode: .none) \/\/ No protection needed","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"What changed","type":"text"}]},{"text":":","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Added "},{"type":"codeVoice","code":"@LockmanSingleExecution"},{"type":"text","text":" macro to the Action enum"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Implemented "},{"type":"codeVoice","code":"lockmanInfo"},{"type":"text","text":" property to configure protection per action"}],"type":"paragraph"}]}]},{"text":"Step 4: Enable Lock Management","type":"heading","anchor":"Step-4-Enable-Lock-Management","level":3},{"inlineContent":[{"type":"text","text":"Finally, add lock management to your reducer:"}],"type":"paragraph"},{"code":["var body: some ReducerOf<Self> {","    Reduce { state, action in","        \/\/ ... same switch statement from Step 2 ...","    }","    .lock(","        boundaryId: CancelID.save,","        lockFailure: { error, send in","            if error is LockmanSingleExecutionError {","                print(\"Save already in progress\")","            }","        }","    )","}","","enum CancelID {","    case save","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"What changed"}]},{"type":"text","text":":"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Added ","type":"text"},{"code":".lock()","type":"codeVoice"},{"text":" modifier to the reducer","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Provided a "},{"code":"boundaryId","type":"codeVoice"},{"type":"text","text":" to identify this lock boundary"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Added error handling for when lock acquisition fails"}]}]}]},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Result"}],"type":"strong"},{"type":"text","text":": Now when users tap save multiple times, only the first tap executes. Additional taps are safely ignored until the save completes."}],"type":"paragraph"},{"text":"Complete Example","type":"heading","anchor":"Complete-Example","level":2},{"inlineContent":[{"text":"Here’s the complete, working example:","type":"text"}],"type":"paragraph"},{"code":["import ComposableArchitecture","import Lockman","","@Reducer","struct SaveFeature {","    @ObservableState","    struct State: Equatable {","        var isSaving = false","        var message = \"\"","    }","    ","    @LockmanSingleExecution","    enum Action {","        case saveButtonTapped","        case saveCompleted","        ","        var lockmanInfo: LockmanSingleExecutionInfo {","            switch self {","            case .saveButtonTapped:","                return .init(actionId: actionName, mode: .boundary)","            case .saveCompleted:","                return .init(actionId: actionName, mode: .none)","            }","        }","    }","    ","    var body: some ReducerOf<Self> {","        Reduce { state, action in","            switch action {","            case .saveButtonTapped:","                state.isSaving = true","                state.message = \"Saving...\"","                return .run { send in","                    try await Task.sleep(for: .seconds(2))","                    await send(.saveCompleted)","                }","                ","            case .saveCompleted:","                state.isSaving = false","                state.message = \"Saved successfully!\"","                return .none","            }","        }","        .lock(","            boundaryId: CancelID.save,","            lockFailure: { error, send in","                if error is LockmanSingleExecutionError {","                    print(\"Save already in progress\")","                }","            }","        )","    }","    ","    enum CancelID {","        case save","    }","}"],"type":"codeListing","syntax":"swift"},{"text":"Next Steps","type":"heading","anchor":"Next-Steps","level":2},{"inlineContent":[{"type":"text","text":"Congratulations! You’ve successfully implemented your first Lockman feature. Here’s what to explore next:"}],"type":"paragraph"},{"text":"Learn Other Strategies","type":"heading","anchor":"Learn-Other-Strategies","level":3},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Priority-based control","type":"text"}],"type":"strong"},{"text":": ","type":"text"},{"overridingTitleInlineContent":[{"code":"PriorityBasedStrategy","type":"codeVoice"}],"isActive":true,"overridingTitle":"PriorityBasedStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","type":"reference"},{"text":" - Cancel existing operations for higher priority ones","type":"text"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Concurrency limits","type":"text"}],"type":"strong"},{"type":"text","text":": "},{"overridingTitleInlineContent":[{"type":"codeVoice","code":"ConcurrencyLimitedStrategy"}],"isActive":true,"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","overridingTitle":"ConcurrencyLimitedStrategy","type":"reference"},{"type":"text","text":" - Limit how many operations run simultaneously"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Group coordination","type":"text"}],"type":"strong"},{"text":": ","type":"text"},{"overridingTitle":"GroupCoordinationStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","type":"reference","overridingTitleInlineContent":[{"type":"codeVoice","code":"GroupCoordinationStrategy"}],"isActive":true},{"text":" - Coordinate related operations","type":"text"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Custom logic","type":"text"}],"type":"strong"},{"text":": ","type":"text"},{"overridingTitle":"DynamicConditionStrategy","isActive":true,"type":"reference","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","overridingTitleInlineContent":[{"type":"codeVoice","code":"DynamicConditionStrategy"}]},{"text":" - Create your own rules","type":"text"}],"type":"paragraph"}]}]},{"text":"Strategy Selection Guide","type":"heading","anchor":"Strategy-Selection-Guide","level":3},{"inlineContent":[{"type":"text","text":"Not sure which strategy to use? Check out "},{"overridingTitle":"Choosing Strategy","type":"reference","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","overridingTitleInlineContent":[{"text":"Choosing Strategy","type":"text"}],"isActive":true},{"type":"text","text":" for guidance on picking the right approach."}],"type":"paragraph"},{"text":"Advanced Topics","type":"heading","anchor":"Advanced-Topics","level":3},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","overridingTitle":"Boundary Overview","overridingTitleInlineContent":[{"text":"Boundary Overview","type":"text"}]},{"type":"text","text":" - Understanding lock boundaries"}]}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","overridingTitleInlineContent":[{"text":"Error Handling","type":"text"}],"overridingTitle":"Error Handling"},{"type":"text","text":" - Comprehensive error management"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","overridingTitle":"Configuration","overridingTitleInlineContent":[{"type":"text","text":"Configuration"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Configuration","isActive":true},{"type":"text","text":" - Global settings and customization"}],"type":"paragraph"}]}]},{"text":"Alternative API: Effect.lock()","type":"heading","anchor":"Alternative-API-Effectlock","level":2},{"inlineContent":[{"text":"If you prefer method chaining on individual effects, you can use ","type":"text"},{"code":"Effect.lock()","type":"codeVoice"},{"text":":","type":"text"}],"type":"paragraph"},{"code":["case .saveButtonTapped:","    return .run { send in","        try await Task.sleep(for: .seconds(2))","        await send(.saveCompleted)","    }","    .lock(","        action: action,","        boundaryId: CancelID.save,","        lockFailure: { error, send in","            if error is LockmanSingleExecutionError {","                print(\"Save already in progress\")","            }","        }","    )"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"This approach gives you the same protection but applies to individual effects rather than the entire reducer."}],"type":"paragraph"}]}],"metadata":{"title":"Getting Started","modules":[{"name":"Lockman"}],"role":"article","roleHeading":"Article"},"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lockman\/documentation\/Lockman\/GettingStarted"},"schemaVersion":{"major":0,"patch":0,"minor":3},"abstract":[{"type":"text","text":"Learn how to integrate Lockman into your TCA application."}],"seeAlsoSections":[{"anchor":"Essentials","generated":true,"identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","doc:\/\/Lockman\/documentation\/Lockman\/Lock","doc:\/\/Lockman\/documentation\/Lockman\/Unlock","doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","doc:\/\/Lockman\/documentation\/Lockman\/Configuration","doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide"],"title":"Essentials"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/lockman\/gettingstarted"]}],"hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"references":{"doc://Lockman/documentation/Lockman/ErrorHandling":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","url":"\/documentation\/lockman\/errorhandling","role":"article","abstract":[{"text":"Learn about common error handling patterns in Lockman.","type":"text"}],"type":"topic","title":"Error Handling"},"doc://Lockman/documentation/Lockman/Lock":{"abstract":[{"type":"text","text":"Understanding the locking mechanism in Lockman."}],"role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Lock","url":"\/documentation\/lockman\/lock","type":"topic","title":"Lock","kind":"article"},"doc://Lockman/documentation/Lockman/Configuration":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Configuration","url":"\/documentation\/lockman\/configuration","abstract":[{"type":"text","text":"Configure Lockman for your application’s needs."}],"type":"topic","role":"article","title":"Configuration"},"doc://Lockman/documentation/Lockman/DynamicConditionStrategy":{"kind":"article","type":"topic","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","url":"\/documentation\/lockman\/dynamicconditionstrategy","title":"Dynamic Condition Evaluation","abstract":[{"type":"text","text":"Control actions based on runtime conditions with unified condition evaluation."}]},"doc://Lockman/documentation/Lockman/DebuggingGuide":{"kind":"article","title":"Debugging Guide","role":"article","type":"topic","url":"\/documentation\/lockman\/debuggingguide","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide","abstract":[{"text":"Learn how to debug Lockman-related issues in your application.","type":"text"}]},"doc://Lockman/documentation/Lockman":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman","type":"topic","url":"\/documentation\/lockman","abstract":[{"type":"text","text":"Elegant exclusive control for user actions in The Composable Architecture applications."}],"title":"Lockman","kind":"symbol","role":"collection"},"doc://Lockman/documentation/Lockman/ChoosingStrategy":{"kind":"article","title":"Choosing a Strategy","role":"article","type":"topic","url":"\/documentation\/lockman\/choosingstrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","abstract":[{"text":"Learn how to select the right strategy for your use case.","type":"text"}]},"doc://Lockman/documentation/Lockman/ConcurrencyLimitedStrategy":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","type":"topic","title":"ConcurrencyLimitedStrategy","kind":"article","url":"\/documentation\/lockman\/concurrencylimitedstrategy","role":"article","abstract":[{"type":"text","text":"Limit the number of concurrent executions."}]},"doc://Lockman/documentation/Lockman/PriorityBasedStrategy":{"role":"article","kind":"article","abstract":[{"type":"text","text":"Control action execution based on priority levels."}],"title":"PriorityBasedStrategy","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy","url":"\/documentation\/lockman\/prioritybasedstrategy","type":"topic"},"doc://Lockman/documentation/Lockman/Unlock":{"title":"Unlock","kind":"article","type":"topic","url":"\/documentation\/lockman\/unlock","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Unlock","role":"article","abstract":[{"text":"Understanding the unlocking mechanism in Lockman.","type":"text"}]},"doc://Lockman/documentation/Lockman/GroupCoordinationStrategy":{"type":"topic","title":"GroupCoordinationStrategy","url":"\/documentation\/lockman\/groupcoordinationstrategy","kind":"article","abstract":[{"text":"Coordinate actions through leader\/member group roles.","type":"text"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","role":"article"},"doc://Lockman/documentation/Lockman/BoundaryOverview":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","url":"\/documentation\/lockman\/boundaryoverview","kind":"article","type":"topic","title":"Boundary","abstract":[{"type":"text","text":"Understand the concept of boundaries in Lockman."}],"role":"article"},"https://pointfreeco.github.io/swift-composable-architecture/main/tutorials/composablearchitecture/":{"type":"link","url":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/tutorials\/composablearchitecture\/","identifier":"https:\/\/pointfreeco.github.io\/swift-composable-architecture\/main\/tutorials\/composablearchitecture\/","titleInlineContent":[{"type":"text","text":"official TCA tutorial"}],"title":"official TCA tutorial"}}}