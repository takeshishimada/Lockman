{"variants":[{"paths":["\/documentation\/lockman\/gettingstarted"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lockman\/documentation\/Lockman\/GettingStarted"},"sections":[],"schemaVersion":{"minor":3,"major":0,"patch":0},"seeAlsoSections":[{"anchor":"Essentials","generated":true,"title":"Essentials","identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","doc:\/\/Lockman\/documentation\/Lockman\/Lock","doc:\/\/Lockman\/documentation\/Lockman\/Unlock","doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","doc:\/\/Lockman\/documentation\/Lockman\/Configuration","doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide"]}],"metadata":{"role":"article","roleHeading":"Article","modules":[{"name":"Lockman"}],"title":"Getting Started"},"kind":"article","abstract":[{"type":"text","text":"Learn how to integrate Lockman into your TCA application."}],"hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"type":"paragraph","inlineContent":[{"text":"This guide will teach you how to integrate Lockman into your The Composable Architecture (TCA) project and implement your first feature.","type":"text"}]},{"type":"heading","level":2,"text":"Adding Lockman as a dependency","anchor":"Adding-Lockman-as-a-dependency"},{"type":"paragraph","inlineContent":[{"text":"To use Lockman in a Swift Package Manager project, add it to the dependencies in your ","type":"text"},{"type":"codeVoice","code":"Package.swift"},{"text":" file:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["dependencies: [","  .package(url: \"https:\/\/github.com\/takeshishimada\/Lockman\", from: \"0.11.0\")","]"]},{"type":"paragraph","inlineContent":[{"text":"And add ","type":"text"},{"type":"codeVoice","code":"Lockman"},{"text":" as a dependency of your package’s target:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":[".target(","  name: \"YourTarget\",","  dependencies: [","    \"Lockman\",","    .product(name: \"ComposableArchitecture\", package: \"swift-composable-architecture\")","  ]",")"]},{"type":"heading","level":2,"text":"Writing your first feature","anchor":"Writing-your-first-feature"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Let’s implement a feature that prevents duplicate execution of processes using the "},{"overridingTitle":"@LockmanSingleExecution","isActive":true,"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","overridingTitleInlineContent":[{"code":"@LockmanSingleExecution","type":"codeVoice"}],"type":"reference"},{"type":"text","text":" macro."}]},{"type":"heading","level":3,"text":"Step 1: Define the Reducer","anchor":"Step-1-Define-the-Reducer"},{"type":"paragraph","inlineContent":[{"text":"First, define the basic Reducer structure:","type":"text"}]},{"code":["import ComposableArchitecture","import Lockman","","@Reducer","struct ProcessFeature {","}"],"type":"codeListing","syntax":"swift"},{"anchor":"Step-2-Define-State-and-Action","level":3,"type":"heading","text":"Step 2: Define State and Action"},{"inlineContent":[{"text":"Define the State to manage the processing status and the available actions:","type":"text"}],"type":"paragraph"},{"code":["@Reducer","struct ProcessFeature {","    @ObservableState","    struct State: Equatable {","        var isProcessing = false","        var message = \"\"","    }","    ","    @LockmanSingleExecution","    enum Action {","        case startProcessButtonTapped","        case processStart","        case processCompleted","        ","        var lockmanInfo: LockmanSingleExecutionInfo {","            switch self {","            case .startProcessButtonTapped:","                return .init(actionId: actionName, mode: .boundary)","            case .processStart, .processCompleted:","                return .init(actionId: actionName, mode: .none)","            }","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Key points:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Applying the ","type":"text"},{"overridingTitleInlineContent":[{"type":"codeVoice","code":"@LockmanSingleExecution"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","isActive":true,"overridingTitle":"@LockmanSingleExecution","type":"reference"},{"text":" macro to the Action enum makes it conform to the ","type":"text"},{"code":"LockmanSingleExecutionAction","type":"codeVoice"},{"text":" protocol","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"lockmanInfo"},{"type":"text","text":" property defines how each action is controlled for locking:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Control parameter configuration: Specifies strategy-specific behavior settings (priority, concurrency limits, group coordination rules, etc.)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Action identification: Provides the action identifier within the lock management system"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Inter-strategy coordination: Defines parameters to pass to each strategy when using composite strategies","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"anchor":"Step-3-Define-CancelID","level":3,"type":"heading","text":"Step 3: Define CancelID"},{"inlineContent":[{"text":"Define a ","type":"text"},{"code":"CancelID","type":"codeVoice"},{"text":" to use as the cancellation identifier for Effects:","type":"text"}],"type":"paragraph"},{"code":["extension ProcessFeature {","    enum CancelID {","        case userAction","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"codeVoice","code":"CancelID"},{"type":"text","text":" is used for Effect cancellation and lock boundary identification."}],"type":"paragraph"},{"anchor":"Step-4-Implement-the-Reducer-body","level":3,"type":"heading","text":"Step 4: Implement the Reducer body"},{"inlineContent":[{"text":"Implement processing with exclusive control using the ","type":"text"},{"isActive":true,"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Lock","overridingTitle":"withLock","overridingTitleInlineContent":[{"code":"withLock","type":"codeVoice"}],"type":"reference"},{"text":" method:","type":"text"}],"type":"paragraph"},{"code":["var body: some Reducer<State, Action> {","    Reduce { state, action in","        switch action {","        case .startProcessButtonTapped:","            return .withLock(","                operation: { send in","                    await send(.processStart)","                    \/\/ Simulate heavy processing","                    try await Task.sleep(nanoseconds: 3_000_000_000)","                    await send(.processCompleted)","                },","                lockFailure: { error, send in","                    \/\/ When processing is already in progress","                    state.message = \"Processing is already in progress\"","                },","                action: action,","                cancelID: CancelID.userAction","            )","            ","        case .processStart:","            state.isProcessing = true","            state.message = \"Processing started...\"","            return .none","            ","        case .processCompleted:","            state.isProcessing = false","            state.message = \"Processing completed\"","            return .none","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Key points about the ","type":"text"},{"isActive":true,"type":"reference","overridingTitle":"withLock","overridingTitleInlineContent":[{"type":"codeVoice","code":"withLock"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Lock"},{"text":" method:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"operation","type":"codeVoice"},{"type":"text","text":": Defines the processing to be executed under exclusive control"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"lockFailure"},{"type":"text","text":": Handler called when the same processing is already in progress"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"action","type":"codeVoice"},{"text":": Passes the currently processing action","type":"text"}]}]},{"content":[{"inlineContent":[{"code":"cancelID","type":"codeVoice"},{"type":"text","text":": Specifies the identifier for Effect cancellation and lock boundary"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"text":"With this implementation, the ","type":"text"},{"type":"codeVoice","code":"startProcessButtonTapped"},{"text":" action will not be executed again while processing, making it safe even if the user accidentally taps the button multiple times.","type":"text"}],"type":"paragraph"}],"kind":"content"}],"references":{"doc://Lockman/documentation/Lockman/ChoosingStrategy":{"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ChoosingStrategy","abstract":[{"text":"Learn how to select the right strategy for your use case.","type":"text"}],"role":"article","type":"topic","url":"\/documentation\/lockman\/choosingstrategy","title":"Choosing a Strategy"},"doc://Lockman/documentation/Lockman/Lock":{"kind":"article","abstract":[{"type":"text","text":"Understanding the locking mechanism in Lockman."}],"url":"\/documentation\/lockman\/lock","title":"Lock","role":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Lock","type":"topic"},"doc://Lockman/documentation/Lockman/SingleExecutionStrategy":{"url":"\/documentation\/lockman\/singleexecutionstrategy","title":"SingleExecutionStrategy","abstract":[{"type":"text","text":"Prevent duplicate execution of the same action."}],"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","type":"topic","role":"article"},"doc://Lockman/documentation/Lockman/Configuration":{"title":"Configuration","url":"\/documentation\/lockman\/configuration","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Configuration","kind":"article","type":"topic","abstract":[{"type":"text","text":"Configure Lockman for your application’s needs."}],"role":"article"},"doc://Lockman/documentation/Lockman/ErrorHandling":{"kind":"article","url":"\/documentation\/lockman\/errorhandling","role":"article","title":"Error Handling","type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","abstract":[{"type":"text","text":"Learn about common error handling patterns in Lockman."}]},"doc://Lockman/documentation/Lockman/BoundaryOverview":{"abstract":[{"text":"Understand the concept of boundaries in Lockman.","type":"text"}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/BoundaryOverview","title":"Boundary","kind":"article","role":"article","url":"\/documentation\/lockman\/boundaryoverview","type":"topic"},"doc://Lockman/documentation/Lockman/DebuggingGuide":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DebuggingGuide","url":"\/documentation\/lockman\/debuggingguide","kind":"article","type":"topic","title":"Debugging Guide","abstract":[{"text":"Learn how to debug Lockman-related issues in your application.","type":"text"}],"role":"article"},"doc://Lockman/documentation/Lockman":{"role":"collection","url":"\/documentation\/lockman","title":"Lockman","kind":"symbol","abstract":[{"text":"A library to implement exclusive control of user actions in application development using TCA.","type":"text"}],"type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman"},"doc://Lockman/documentation/Lockman/Unlock":{"abstract":[{"type":"text","text":"Understanding the unlocking mechanism in Lockman."}],"identifier":"doc:\/\/Lockman\/documentation\/Lockman\/Unlock","title":"Unlock","kind":"article","role":"article","url":"\/documentation\/lockman\/unlock","type":"topic"}}}