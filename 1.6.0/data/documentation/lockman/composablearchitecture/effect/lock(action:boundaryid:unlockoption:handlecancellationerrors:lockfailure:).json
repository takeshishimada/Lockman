{"metadata":{"modules":[{"relatedModules":["ComposableArchitecture"],"name":"Lockman"}],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"lock"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"B"},{"kind":"text","text":", "},{"kind":"genericParameter","text":"A"},{"kind":"text","text":">("},{"kind":"externalParam","text":"action"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"A"},{"kind":"text","text":", "},{"kind":"externalParam","text":"boundaryId"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"B"},{"kind":"text","text":", "},{"kind":"externalParam","text":"unlockOption"},{"kind":"text","text":": "},{"preciseIdentifier":"s:7Lockman0A12UnlockOptionO","kind":"typeIdentifier","text":"LockmanUnlockOption"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"handleCancellationErrors"},{"kind":"text","text":": "},{"preciseIdentifier":"s:Sb","kind":"typeIdentifier","text":"Bool"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"lockFailure"},{"kind":"text","text":": ((any "},{"preciseIdentifier":"s:s5ErrorP","kind":"typeIdentifier","text":"Error"},{"kind":"text","text":", "},{"preciseIdentifier":"s:22ComposableArchitecture4SendV","kind":"typeIdentifier","text":"Send"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":">) "},{"kind":"keyword","text":"async"},{"kind":"text","text":" -> "},{"preciseIdentifier":"s:s4Voida","kind":"typeIdentifier","text":"Void"},{"kind":"text","text":")?) -> "},{"preciseIdentifier":"s:22ComposableArchitecture6EffectV","kind":"typeIdentifier","text":"Effect"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":">"}],"roleHeading":"Instance Method","title":"lock(action:boundaryId:unlockOption:handleCancellationErrors:lockFailure:)","extendedModule":"ComposableArchitecture","role":"symbol","externalID":"s:22ComposableArchitecture6EffectV7LockmanE4lock6action10boundaryId12unlockOption24handleCancellationErrors0E7FailureACyxGqd_0__qd__AD0d6UnlockJ0OSgSbSgys5Error_p_AA4SendVyxGtYaYbcSgtSHRd__s8SendableRd__AD0D6ActionRd_0_r0_lF","symbolKind":"method"},"abstract":[{"type":"text","text":"Applies lock management to this effect using a method chain style."}],"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture\/Effect\/lock(action:boundaryId:unlockOption:handleCancellationErrors:lockFailure:)"},"primaryContentSections":[{"declarations":[{"languages":["swift"],"platforms":["macOS"],"tokens":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"lock"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"B"},{"kind":"text","text":", "},{"kind":"genericParameter","text":"A"},{"kind":"text","text":">("},{"kind":"externalParam","text":"action"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"A"},{"kind":"text","text":", "},{"kind":"externalParam","text":"boundaryId"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"B"},{"kind":"text","text":", "},{"kind":"externalParam","text":"unlockOption"},{"kind":"text","text":": "},{"kind":"typeIdentifier","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/LockmanUnlockOption","text":"LockmanUnlockOption","preciseIdentifier":"s:7Lockman0A12UnlockOptionO"},{"kind":"text","text":"? = nil, "},{"kind":"externalParam","text":"handleCancellationErrors"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"},{"kind":"text","text":"? = nil, "},{"kind":"externalParam","text":"lockFailure"},{"kind":"text","text":": ((any "},{"kind":"typeIdentifier","text":"Error","preciseIdentifier":"s:s5ErrorP"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"Send","preciseIdentifier":"s:22ComposableArchitecture4SendV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":">) "},{"kind":"keyword","text":"async"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Void","preciseIdentifier":"s:s4Voida"},{"kind":"text","text":")? = nil) -> "},{"kind":"typeIdentifier","text":"Effect","preciseIdentifier":"s:22ComposableArchitecture6EffectV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":"> "},{"kind":"keyword","text":"where"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"B"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","text":"Hashable","preciseIdentifier":"s:SH"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"B"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","text":"Sendable","preciseIdentifier":"s:s8SendableP"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"A"},{"kind":"text","text":" : "},{"kind":"typeIdentifier","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/LockmanAction","text":"LockmanAction","preciseIdentifier":"s:7Lockman0A6ActionP"}]}],"kind":"declarations"},{"kind":"parameters","parameters":[{"name":"action","content":[{"type":"paragraph","inlineContent":[{"text":"LockmanAction providing lock information and strategy type","type":"text"}]}]},{"name":"boundaryId","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Unique identifier for effect cancellation and lock boundary"}]}]},{"name":"unlockOption","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Controls when the unlock operation is executed (default: uses action’s option)"}]}]},{"name":"handleCancellationErrors","content":[{"type":"paragraph","inlineContent":[{"text":"Whether to pass CancellationError to catch handler (default: global config)","type":"text"}]}]},{"name":"lockFailure","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Optional handler for lock acquisition failures"}]}]}]},{"kind":"content","content":[{"type":"heading","level":2,"text":"Return Value","anchor":"return-value"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Effect with automatic lock management"}]}]},{"kind":"content","content":[{"type":"heading","level":2,"text":"Discussion","anchor":"discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This method provides a method chain style API for applying lock management to effects."},{"type":"text","text":" "},{"type":"text","text":"The lock strategy is automatically resolved from the container using the action’s strategy ID."}]},{"type":"heading","level":2,"text":"UniqueId Consistency","anchor":"UniqueId-Consistency"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This method captures the action’s lockmanInfo once at the beginning to ensure consistent"},{"type":"text","text":" "},{"type":"text","text":"uniqueId values throughout the lock lifecycle, preventing lock\/unlock mismatches."}]},{"type":"heading","level":2,"text":"Automatic Cancellation Management","anchor":"Automatic-Cancellation-Management"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This method automatically applies "},{"type":"codeVoice","code":".cancellable(id: boundaryId)"},{"type":"text","text":" to the chained effect,"},{"type":"text","text":" "},{"type":"text","text":"eliminating the need to manually specify cancellation IDs. This provides a clean,"},{"type":"text","text":" "},{"type":"text","text":"method-chain style API with automatic cancellation handling."}]},{"type":"heading","level":2,"text":"Usage Examples","anchor":"Usage-Examples"},{"type":"codeListing","code":["\/\/ Simple operation with automatic cancellation","return .run { send in","  await performAsyncWork()","  await send(.completed)","}",".lock(action: action, boundaryId: Feature.self)","\/\/ No need for .cancellable(id:) - applied automatically","","\/\/ Method chaining with other effects","return .merge(","  .run { send in await send(.started) },","  .run { send in","    await performWork()","    await send(.finished)","  }","  .lock(action: action, boundaryId: MyFeature.self)",")"],"syntax":"swift"},{"type":"heading","level":2,"text":"Requirements","anchor":"Requirements"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The action must implement "},{"code":"LockmanAction","type":"codeVoice"},{"type":"text","text":" to provide lock information"}]}]}]}]}],"schemaVersion":{"minor":3,"major":0,"patch":0},"variants":[{"paths":["\/documentation\/lockman\/composablearchitecture\/effect\/lock(action:boundaryid:unlockoption:handlecancellationerrors:lockfailure:)"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"symbol","hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman","doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture","doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture\/Effect"]]},"references":{"doc://Lockman/documentation/Lockman/ComposableArchitecture/Effect":{"navigatorTitle":[{"kind":"identifier","text":"Effect"}],"fragments":[{"kind":"keyword","text":"extension"},{"kind":"text","text":" "},{"kind":"identifier","preciseIdentifier":"s:22ComposableArchitecture6EffectV","text":"Effect"}],"url":"\/documentation\/lockman\/composablearchitecture\/effect","type":"topic","role":"symbol","kind":"symbol","abstract":[],"title":"Effect","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture\/Effect"},"doc://Lockman/documentation/Lockman":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman","kind":"symbol","type":"topic","abstract":[{"type":"text","text":"Elegant exclusive control for user actions in The Composable Architecture applications."}],"url":"\/documentation\/lockman","role":"collection","title":"Lockman"},"doc://Lockman/documentation/Lockman/ComposableArchitecture/Effect/lock(action:boundaryId:unlockOption:handleCancellationErrors:lockFailure:)":{"kind":"symbol","abstract":[{"type":"text","text":"Applies lock management to this effect using a method chain style."}],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"lock"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"B"},{"kind":"text","text":", "},{"kind":"genericParameter","text":"A"},{"kind":"text","text":">("},{"kind":"externalParam","text":"action"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"A"},{"kind":"text","text":", "},{"kind":"externalParam","text":"boundaryId"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"B"},{"kind":"text","text":", "},{"kind":"externalParam","text":"unlockOption"},{"kind":"text","text":": "},{"preciseIdentifier":"s:7Lockman0A12UnlockOptionO","kind":"typeIdentifier","text":"LockmanUnlockOption"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"handleCancellationErrors"},{"kind":"text","text":": "},{"preciseIdentifier":"s:Sb","kind":"typeIdentifier","text":"Bool"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"lockFailure"},{"kind":"text","text":": ((any "},{"preciseIdentifier":"s:s5ErrorP","kind":"typeIdentifier","text":"Error"},{"kind":"text","text":", "},{"preciseIdentifier":"s:22ComposableArchitecture4SendV","kind":"typeIdentifier","text":"Send"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":">) "},{"kind":"keyword","text":"async"},{"kind":"text","text":" -> "},{"preciseIdentifier":"s:s4Voida","kind":"typeIdentifier","text":"Void"},{"kind":"text","text":")?) -> "},{"preciseIdentifier":"s:22ComposableArchitecture6EffectV","kind":"typeIdentifier","text":"Effect"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Action"},{"kind":"text","text":">"}],"role":"symbol","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture\/Effect\/lock(action:boundaryId:unlockOption:handleCancellationErrors:lockFailure:)","title":"lock(action:boundaryId:unlockOption:handleCancellationErrors:lockFailure:)","type":"topic","url":"\/documentation\/lockman\/composablearchitecture\/effect\/lock(action:boundaryid:unlockoption:handlecancellationerrors:lockfailure:)"},"doc://Lockman/documentation/Lockman/LockmanUnlockOption":{"fragments":[{"text":"enum","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LockmanUnlockOption","kind":"identifier"}],"role":"symbol","abstract":[{"text":"Controls when unlock operations are executed.","type":"text"}],"navigatorTitle":[{"text":"LockmanUnlockOption","kind":"identifier"}],"type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/LockmanUnlockOption","url":"\/documentation\/lockman\/lockmanunlockoption","kind":"symbol","title":"LockmanUnlockOption"},"doc://Lockman/documentation/Lockman/ComposableArchitecture":{"abstract":[],"url":"\/documentation\/lockman\/composablearchitecture","kind":"symbol","role":"collection","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ComposableArchitecture","title":"ComposableArchitecture","type":"topic"},"doc://Lockman/documentation/Lockman/LockmanAction":{"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LockmanAction","kind":"identifier"}],"type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/LockmanAction","kind":"symbol","navigatorTitle":[{"text":"LockmanAction","kind":"identifier"}],"title":"LockmanAction","abstract":[{"text":"An action that participates in Lockman’s locking mechanism.","type":"text"}],"url":"\/documentation\/lockman\/lockmanaction","role":"symbol"}}}