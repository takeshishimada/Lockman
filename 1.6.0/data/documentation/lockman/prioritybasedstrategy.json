{"schemaVersion":{"minor":3,"major":0,"patch":0},"metadata":{"title":"PriorityBasedStrategy","role":"article","roleHeading":"Article","modules":[{"name":"Lockman"}]},"seeAlsoSections":[{"generated":true,"title":"Strategies","identifiers":["doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy"],"anchor":"Strategies"}],"abstract":[{"text":"Control action execution based on priority levels.","type":"text"}],"kind":"article","primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"PriorityBasedStrategy is a strategy that performs execution control based on priority. High-priority operations can interrupt low-priority operations to execute, allowing important operations to be handled preferentially."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This strategy is used in situations where high-urgency operations or control based on importance is required."}]},{"type":"heading","level":2,"text":"Priority System","anchor":"Priority-System"},{"type":"heading","level":3,"text":"Priority Levels","anchor":"Priority-Levels"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"high","type":"text"}],"type":"strong"},{"text":" - High Priority","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Can interrupt all other priority operations","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"System-level emergency operations or important user operations","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"low","type":"text"}],"type":"strong"},{"type":"text","text":" - Low Priority"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Can interrupt none priority operations"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Interrupted by high priority"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Regular background operations"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"none","type":"text"}],"type":"strong"},{"text":" - No Priority","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Bypasses priority system","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Not interrupted by other operations"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Basic operations or temporary disabling"}]}]}]},{"type":"heading","level":3,"text":"Exclusive Execution Control","anchor":"Exclusive-Execution-Control"},{"type":"paragraph","inlineContent":[{"text":"Within the same priority level, control is based on the exclusive execution behavior setting of existing operations:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"exclusive"}]},{"type":"text","text":" - Exclusive Execution"}]},{"type":"codeListing","syntax":"swift","code":["LockmanPriorityBasedInfo(","    actionId: \"payment\",","    priority: .high(.exclusive)",")"]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Rejects new operations of the same priority","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Protects important operations from interruption"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"replaceable"}],"type":"strong"},{"text":" - Replaceable Execution","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["LockmanPriorityBasedInfo(","    actionId: \"search\", ","    priority: .high(.replaceable)",")"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Can be interrupted by new operations of the same priority","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Applied to search or update operations"}]}]}]},{"anchor":"Usage","text":"Usage","type":"heading","level":2},{"anchor":"Basic-Usage-Example","text":"Basic Usage Example","type":"heading","level":3},{"syntax":"swift","type":"codeListing","code":["@LockmanPriorityBased","enum ViewAction {","    case emergencySync","    case normalSync","    case backgroundTask","    ","    var lockmanInfo: LockmanPriorityBasedInfo {","        switch self {","        case .emergencySync:","            return LockmanPriorityBasedInfo(","                actionId: actionName,","                priority: .high(.exclusive)","            )","        case .normalSync:","            return LockmanPriorityBasedInfo(","                actionId: actionName,","                priority: .low(.replaceable)","            )","        case .backgroundTask:","            return LockmanPriorityBasedInfo(","                actionId: actionName,","                priority: .none","            )","        }","    }","}"]},{"anchor":"Operation-Examples","text":"Operation Examples","type":"heading","level":2},{"anchor":"Interruption-by-Priority","text":"Interruption by Priority","type":"heading","level":3},{"syntax":null,"type":"codeListing","code":["Time: 0s  - Low priority process starts    ‚Üí ‚úÖ Execute","Time: 2s  - High priority process request  ‚Üí ‚úÖ Execute (interrupts low process)","Time: 2s  - Low priority process           ‚Üí üõë Cancel","Time: 5s  - High priority process complete ‚Üí ‚úÖ Complete"]},{"anchor":"Control-at-Same-Priority","text":"Control at Same Priority","type":"heading","level":3},{"syntax":null,"type":"codeListing","code":["\/\/ Exclusive setting case","Time: 0s  - high(.exclusive) starts  ‚Üí ‚úÖ Execute","Time: 1s  - high(.exclusive) request ‚Üí ‚ùå Reject","Time: 3s  - First process completes  ‚Üí ‚úÖ Complete","Time: 4s  - high(.exclusive) request ‚Üí ‚úÖ Execute","","\/\/ Replaceable setting case","Time: 0s  - high(.replaceable) starts  ‚Üí ‚úÖ Execute","Time: 1s  - high(.replaceable) request ‚Üí ‚úÖ Execute (interrupts previous)","Time: 1s  - First process              ‚Üí üõë Cancel"]},{"anchor":"Error-Handling","text":"Error Handling","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"For errors that may occur with PriorityBasedStrategy and their solutions, please also refer to the common patterns on the "},{"type":"reference","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","isActive":true,"overridingTitleInlineContent":[{"text":"Error Handling","type":"text"}],"overridingTitle":"Error Handling"},{"type":"text","text":" page."}]},{"anchor":"Error-Types","text":"Error Types","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"text":"PriorityBasedStrategy uses two error types, both conforming to ","type":"text"},{"code":"LockmanCancellationError","type":"codeVoice"},{"text":" protocol:","type":"text"}]},{"anchor":"LockmanPriorityBasedBlockedError","text":"LockmanPriorityBasedBlockedError","type":"heading","level":4},{"type":"paragraph","inlineContent":[{"type":"text","text":"Occurs when a new action is blocked due to priority conflicts."}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"BlockedReason cases:"}],"type":"strong"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"higherPriorityExists"}]},{"type":"text","text":" - Higher priority is running"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"samePriorityConflict"}]},{"type":"text","text":" - Conflict at same priority"}],"type":"paragraph"}]}]},{"syntax":"swift","type":"codeListing","code":["lockFailure: { error, send in","    if let blockedError = error as? LockmanPriorityBasedBlockedError {","        switch blockedError.reason {","        case .higherPriorityExists(let requested, let current):","            await send(.priorityConflict(\"Waiting due to high priority process running\"))","        case .samePriorityConflict(let priority):","            await send(.busyMessage(\"Process with same priority is running\"))","        }","    }","}"]},{"anchor":"LockmanPriorityBasedCancellationError","text":"LockmanPriorityBasedCancellationError","type":"heading","level":4},{"type":"paragraph","inlineContent":[{"type":"text","text":"Occurs when an existing action is cancelled by preemption."}]},{"syntax":"swift","type":"codeListing","code":["catch handler: { error, send in","    if let cancellationError = error as? LockmanPriorityBasedCancellationError {","        await send(.processCancelled(\"Interrupted by high priority process: \\(cancellationError.cancelledInfo.actionId)\"))","    }","}"]}],"kind":"content"}],"hierarchy":{"paths":[["doc:\/\/Lockman\/documentation\/Lockman"]]},"sections":[],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/lockman\/prioritybasedstrategy"]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Lockman\/documentation\/Lockman\/PriorityBasedStrategy"},"references":{"doc://Lockman/documentation/Lockman":{"identifier":"doc:\/\/Lockman\/documentation\/Lockman","kind":"symbol","type":"topic","abstract":[{"type":"text","text":"Elegant exclusive control for user actions in The Composable Architecture applications."}],"url":"\/documentation\/lockman","role":"collection","title":"Lockman"},"doc://Lockman/documentation/Lockman/CompositeStrategy":{"title":"CompositeStrategy","type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/CompositeStrategy","role":"article","abstract":[{"text":"Combine multiple strategies for complex control scenarios.","type":"text"}],"kind":"article","url":"\/documentation\/lockman\/compositestrategy"},"doc://Lockman/documentation/Lockman/ConcurrencyLimitedStrategy":{"abstract":[{"text":"Limit the number of concurrent executions.","type":"text"}],"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ConcurrencyLimitedStrategy","role":"article","title":"ConcurrencyLimitedStrategy","type":"topic","url":"\/documentation\/lockman\/concurrencylimitedstrategy"},"doc://Lockman/documentation/Lockman/SingleExecutionStrategy":{"abstract":[{"text":"Prevent duplicate execution of the same action.","type":"text"}],"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/SingleExecutionStrategy","role":"article","title":"SingleExecutionStrategy","type":"topic","url":"\/documentation\/lockman\/singleexecutionstrategy"},"doc://Lockman/documentation/Lockman/DynamicConditionStrategy":{"abstract":[{"type":"text","text":"Control actions based on runtime conditions with unified condition evaluation."}],"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/DynamicConditionStrategy","role":"article","title":"Dynamic Condition Evaluation","type":"topic","url":"\/documentation\/lockman\/dynamicconditionstrategy"},"doc://Lockman/documentation/Lockman/ErrorHandling":{"abstract":[{"text":"Learn about common error handling patterns in Lockman.","type":"text"}],"type":"topic","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/ErrorHandling","kind":"article","url":"\/documentation\/lockman\/errorhandling","role":"article","title":"Error Handling"},"doc://Lockman/documentation/Lockman/GroupCoordinationStrategy":{"abstract":[{"text":"Coordinate actions through leader\/member group roles.","type":"text"}],"kind":"article","identifier":"doc:\/\/Lockman\/documentation\/Lockman\/GroupCoordinationStrategy","role":"article","title":"GroupCoordinationStrategy","type":"topic","url":"\/documentation\/lockman\/groupcoordinationstrategy"}}}